name: Add README File

on:
  push:
    branches:
      - aws-sam

permissions:
  contents: write

jobs:
  add-readme:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Generate README.md
        run: |
          echo "# Contact Form API" > README.md
          echo "" >> README.md
          echo "This repository contains a serverless application built using AWS SAM." >> README.md
          echo "- 🚀 Auto-deployed on push to \`aws-sam\` branch" >> README.md
          echo "- ☁️ Powered by AWS Lambda + API Gateway" >> README.md
          echo "- 📦 Template: \`sam-template.yaml\`" >> README.md

      - name: Commit and push README.md
        run: |
          git config --global user.name "github-actions"
          git config --global user.email "github-actions@github.com"
          git add README.md
          git diff --cached --quiet || git commit -m "Add dynamic README.md"
          git push origin aws-sam
